---
title: セキュリティ対策
description: システム全体のセキュリティ設計
---

Astranote のセキュリティ設計方針です。

## データ保護

- **通信の暗号化**: 全通信を Cloudflare が提供する TLS/SSL で暗号化します。
- **保存データの保護**: パスワードなどの機密情報は、bcrypt/argon2 等の強力なアルゴリズムでハッシュ化して保存します。
- **バックアップ**: Cloudflare D1 のTime Travel機能により、過去30日間のデータを復元可能にします。

## アプリケーションセキュリティ

- **入力値検証 (Validation)**: Zod を使用し、全てのAPI入力値を厳格に検証します。不正なデータやSQLインジェクションの試行をブロックします。
- **XSS (Cross Site Scripting) 対策**: React/Astro のエスケープ機能を活用し、ユーザー入力の直接描画を防ぎます。特に小説本文のHTMLレンダリング時はサニタイズを行います。
- **CSRF (Cross Site Request Forgery) 対策**: 重要な変更操作にはCSRFトークンまたはSameSite Cookie属性を使用します。
- **レート制限 (Rate Limiting)**: Cloudflare WAF および Workers のレート制限機能により、DDoS攻撃やブルートフォース攻撃を防ぎます。

## APIセキュリティ

- **認証必須**: 公開エンドポイント以外はすべて認証トークンが必要です。
- **スコープ制御**: ユーザーのロールに基づき、アクセス可能なリソースを制限します（例: 他人の小説は編集できない）。
- **CORS設定**: 許可されたオリジン（フロントエンドのドメイン）からのリクエストのみを受け付けます。

## コンテンツモデレーション

- **R18コンテンツ**: フラグによるゾーニングを行い、未成年者への表示を制限します。
- **通報システム**: ユーザーからの通報を受け付け、不適切なコンテンツを迅速に削除できる管理画面を提供します。
