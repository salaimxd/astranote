---
title: アーキテクチャ決定記録（ADR）
description: 重要な技術決定の記録と背景
sidebar:
  badge: Template
---

:::danger[このドキュメントについて]
このドキュメントは重要な技術的決定を記録するためのテンプレートです。
アーキテクチャの意思決定とその背景を文書化してください。
:::

重要な技術的決定を記録するArchitecture Decision Records(ADR)を管理します。決定のコンテキスト、検討した選択肢、決定理由、影響・トレードオフを文書化し、将来のチームメンバーへの知識共有と技術的負債の可視化に活用します。

## ADRとは

Architecture Decision Records（ADR）は、プロジェクトにおける重要な技術的決定を記録するドキュメントです。

### ADRの目的

- 技術選定の背景と理由を明文化
- 将来のチームメンバーへの知識共有
- 技術的負債の可視化
- 決定の見直し時の参照資料

---

## ADRテンプレート

各決定は以下の形式で記録します。

### ADR-XXX: [決定のタイトル]

**ステータス**: [提案中 / 承認済み / 廃止 / 置き換え済み]

**日付**: YYYY-MM-DD

**決定者**: [名前 / チーム名]

#### コンテキスト

（どのような状況・課題があったか）

#### 決定内容

（何を決定したか）

#### 検討した選択肢

| 選択肢 | メリット | デメリット | 備考 |
|--------|---------|-----------|------|
| 選択肢A |  |  |  |
| 選択肢B |  |  |  |
| 選択肢C |  |  |  |

#### 決定理由

（なぜこの選択をしたか）

#### 影響・トレードオフ

- **ポジティブな影響**:
  - (影響を記載)

- **ネガティブな影響**:
  - (影響を記載)

- **技術的負債**:
  - (負債を記載)

#### 関連するADR

- ADR-XXX: [関連する決定]

---

## 記録されたADR一覧

### ADR-001: サービス終了後の書籍アクセス継続性の保証

**ステータス**: 提案中

**日付**: 2026-01-18

**決定者**: プロダクトチーム

#### コンテキスト

NFT Book Marketの主要な差別化ポイントは「プラットフォーム非依存の真の所有権」です。しかし、サービスが終了した場合でも、購入者が書籍を読み続けられる技術的保証がなければ、Kindleと同じ「プラットフォーム依存」の状態になってしまいます。

**Kindleの課題**:
- Amazonがサービス終了すると、購入した全書籍が読めなくなる
- DRM認証サーバー停止で、ダウンロード済み書籍も実質的に無効化
- 所有権の記録自体がAmazonのデータベースに依存

**私たちが保証すべきこと**:
1. **所有権の永続性**: サービス終了後もNFT所有権が証明できる
2. **コンテンツの永続性**: 書籍データが消失しない
3. **リーダーアプリの継続性**: 所有者が書籍を読む手段を確保できる

この3つが揃って初めて、「真のデジタル所有」が実現します。

#### 決定内容

**3層アーキテクチャによる永続性保証**:

1. **所有権レイヤー(On-chain)**: Ethereum上のNFT → プラットフォーム非依存で永続
2. **コンテンツレイヤー(Decentralized Storage)**: Arweave上に書籍EPUB/PDF保存 → 200年間保証
3. **リーダーレイヤー(Open Source App)**: オープンソースのスタンドアロンリーダーアプリ → 誰でもホスト可能

**サービス終了時の移行プロセス**:
- 終了6ヶ月前に告知
- 全ユーザーに「セルフホスト移行キット」を提供
- スタンドアロン版リーダーアプリ(Windows/Mac/Linux/iOS/Android)の配布
- Arweaveゲートウェイ一覧とNFTコントラクトアドレスを公開

#### 検討した選択肢

| 選択肢 | メリット | デメリット | 備考 |
|--------|---------|-----------|------|
| **A. Arweave(永続保存) + オープンソースリーダー** | コンテンツが200年保証で永続。誰でもリーダーをフォーク可能 | 初期保存コスト高(1MB=$0.10程度) | **採用** |
| B. IPFS + Filecoinピン維持 | 初期コスト低。速度が速い | 継続的な支払いが必要。支払い停止でデータ消失リスク | サービス終了時に矛盾 |
| C. 中央集権型サーバー + バックアップ配布 | 実装が簡単 | サービス終了後の保証がない。単一障害点 | Kindleと同じ課題 |
| D. BitTorrent + DHT | 分散保存でコストゼロ | シーダーがいなくなると消失。信頼性が低い | 書籍保存に不適 |

#### 決定理由

**ハイブリッド構成を採用する理由**:

**フェーズ1(サービス運営中): IPFS + Filecoin**
- **速度優先**: IPFSによる高速な読み込み([IPFS vs Arweave比較](https://hedge.guide/feature/arweave-ipfs-comparison-bc202202.html))
- **コスト効率**: Filecoinなら1GBあたり月額$0.0002 = 10年で約¥31と圧倒的に安価([分散型ストレージ比較](https://tottemoyasashiibitcoin.net/entry/2022/07/08/0632))
- **実績**: Anna's Archive等の大規模書籍プロジェクトでIPFS採用実績あり

**フェーズ2(サービス終了時): Arweaveへ自動バックアップ**
- **永続性保証**: 200年間の保存保証で真のアーカイブ化([Arweave詳細](https://gaiax-blockchain.com/arweave))
- **サービス終了後も安心**: 一度の支払い(1GB=$4.64)で永続保存
- **コスト**: 平均的な小説EPUB(2MB)で約¥1.2 → 販売価格に転嫁可能
- **NFTとの親和性**: 多くのNFTプロジェクトがArweaveを採用(Solana NFT等)

**コスト比較(2MBの書籍1冊)**:
| 方式 | 初期 | 10年間 | 50年間 | 200年間 |
|-----|-----|--------|--------|---------|
| Filecoin | $0 | ¥31 | ¥155 | ¥620 |
| Arweave | ¥1.2 | ¥1.2 | ¥1.2 | ¥1.2 |
| AWS S3 | $0 | ¥3,720 | ¥18,600 | ¥74,400 |

**採用方針**:
- サービス運営中: IPFS/Filecoinで運用コスト削減
- サービス終了告知時: 全書籍をArweaveに自動移行(著者負担なし、プラットフォームが負担)
- 著者の選択肢: 発行時点でArweave保存をオプション提供(+¥2で200年保証)

**オープンソースリーダーを提供する理由**:
- 所有権(NFT)とコンテンツ(Arweave)が永続しても、「読む手段」がなければ意味がない
- MIT/Apache 2.0ライセンスで公開 → コミュニティが永続的にメンテナンス可能
- スタンドアロン動作 → 当社サーバーへの依存ゼロ

**セキュリティとDRM**:
- Arweave上のコンテンツは暗号化し、NFT所有者のみアクセス可能な設計
- リーダーアプリがNFT所有権をEthereumで検証 → 所有者のみ復号可能
- サービス終了時: 暗号化鍵をNFTメタデータに統合し、完全自律動作を実現

#### 影響・トレードオフ

- **ポジティブな影響**:
  - ✅ **真の永続性**: Kindle等の競合と決定的に差別化できる
  - ✅ **ユーザー信頼**: 「サービスが終了しても本が読める」という安心感
  - ✅ **著者のリスク削減**: プラットフォーム倒産で自分の作品が消えるリスクゼロ
  - ✅ **マーケティング優位性**: 「200年保存保証」は強力なセールスポイント
  - ✅ **オープンソース文化**: 開発者コミュニティからの信頼獲得

- **ネガティブな影響**:
  - ❌ **初期コスト**: Arweave保存費用(2MBで$0.20)を誰が負担するか
    - **対策**: 著者が初回販売価格に転嫁(例: ¥1,200 → ¥1,230)。または当社が吸収してマーケティング費用と見做す
  - ❌ **技術的複雑性**: Ethereum + Arweave + IPFSのハイブリッド構成が必要
    - **対策**: フェーズ1はIPFS(速度優先)、フェーズ2でArweaveバックアップ追加
  - ❌ **リーダーアプリのメンテナンス**: オープンソース化後、コミュニティが放置する可能性
    - **対策**: 初期3年間は当社が積極的にメンテナンス。DAO組織への移行も検討
  - ❌ **著作権保護の弱体化**: 暗号化鍵が公開されると、技術的にはコピー可能
    - **対策**: 社会規範とコミュニティ規約に依存。技術的DRMは永続性と矛盾

- **技術的負債とリスク緩和**:
  - **Arweaveゲートウェイ依存**: Arweaveネットワークへのアクセスはゲートウェイ経由が一般的
    - **リスク**: 主要ゲートウェイ(arweave.net等)が停止すると一時的にアクセス不可
    - **緩和策**: 複数ゲートウェイのフォールバック、セルフホストゲートウェイの推奨、公式ドキュメントで代替ゲートウェイ一覧を提供
  - **Ethereum依存**: NFT検証にEthereumノードが必要
    - **リスク**: Ethereumネットワークが廃れる可能性(ただし現実的には極めて低い)
  - **緩和策**: 他チェーン(Polygon, Arbitrum等)へのブリッジも検討
- **IPFS→Arweave移行コスト**: サービス終了時に全書籍をArweaveに移行する費用
  - **試算**: 10,000冊(各2MB) = 20GB = 約$93 (約¥12,000)
  - **対策**: 事業計画に「サービス終了準備金」として計上。または著者に事前告知して移行費用負担を依頼

**サービス終了シナリオの具体例**:

1. **T-6ヶ月: サービス終了告知**
   - 全著者・読者にメール通知
   - 全書籍をIPFSからArweaveに自動移行開始(プラットフォーム負担)
   - 移行進捗ダッシュボードを公開

2. **T-3ヶ月: セルフホスト移行キット配布**
   - スタンドアロン版リーダーアプリ(Windows/Mac/Linux/iOS/Android)の配布
   - オープンソースリポジトリ(GitHub)に全コード公開
   - 技術ドキュメント: Arweaveゲートウェイ一覧、NFTコントラクトアドレス、復号鍵取得方法

3. **T-1ヶ月: 最終動作確認**
   - 全ユーザーに「セルフホスト版での読書テスト」を依頼
   - コミュニティフォーラムで技術サポート提供

4. **T=0: サービス終了**
   - 当社運営のWebサービス停止
   - ユーザーはスタンドアロンアプリで引き続き読書可能
   - Arweave上のデータは200年間保証
   - NFT所有権はEthereum上に永続

5. **T+1年: コミュニティ移行**
   - オープンソースプロジェクトとしてコミュニティに運営移管
   - DAO組織への移行を検討(投票権はNFT保有数に比例)
   - 当社は技術顧問として引き続きサポート(任意)

#### 関連するADR

- ADR-002: NFT供給モデル(無限供給による投機抑制)
- ADR-003: マルチデバイス読書とセッション管理
- ADR-004: 著者への収益配分とスマートコントラクト設計

---

### ADR-002: 無限供給NFTモデルによる投機抑制

**ステータス**: 提案中

**日付**: 2026-01-18

**決定者**: プロダクトチーム

#### コンテキスト

NFT市場では、希少性(限定発行)が投機的取引を誘発し、本来の価値(書籍の場合は「読むこと」)が軽視される問題が多発しています。

**投機の弊害**:
- 読まずに転売目的で購入される
- 二次流通価格が高騰し、本当に読みたい人が買えなくなる
- 著者の作品が「投資商品」として扱われ、ブランド毀損

**私たちの目指す姿**:
- NFT技術を使いつつ、健全な読書文化を維持
- 「所有の自由」と「投機の防止」の両立

従来検討していた技術的制約(クールダウン期間、転売回数制限、価格上限設定等)は複雑で、UXを損ねる上に抜け穴も多い。もっとシンプルで根本的な解決策が必要。

#### 決定内容

**無限供給(Unlimited Supply)モデルの採用**

- 全ての書籍NFTは**発行上限なし**で販売
- 著者が設定した定価(例: ¥1,200)で誰でもいつでもミント可能
- 希少性による価格上昇が構造的に不可能

**二次流通市場の位置づけ**:
- 二次流通も可能だが、一次販売(ミント)と同価格で常に入手可能
- 転売価格が定価を上回る経済的インセンティブがゼロ
- 二次流通は「読み終わった本を譲る」文化的行為として位置付け

**限定版の扱い**:
- 特典コンテンツ(サイン入りカバー、著者音声コメンタリー等)は別NFTとして発行
- 本文コンテンツ自体は常に無限供給を維持

#### 検討した選択肢

| 選択肢 | メリット | デメリット | 備考 |
|--------|---------|-----------|------|
| **A. 無限供給モデル** | 投機が構造的に不可能。シンプル。読者フレンドリー | 希少性による話題性ゼロ。コレクター需要低い | **採用** |
| B. 限定発行 + 技術的制約(クールダウン等) | 希少性でマーケティング効果。二次市場活性化 | 複雑。抜け穴多い。投機抑制の保証なし | 実効性に疑問 |
| C. ソウルバウンドトークン(譲渡不可) | 投機完全防止 | 譲渡・相続不可。ウォレット移行不可。「所有」の価値喪失 | 過度な制約 |
| D. ダイナミックプライシング(需要で価格変動) | 市場原理で適正価格 | 投機をむしろ助長。著者が価格コントロール不可 | 投機抑制と矛盾 |

#### 決定理由

**無限供給が投機を無効化するロジック**:
1. 転売屋が¥1,200で購入 → 二次市場で¥2,000で出品
2. 買い手は「一次ミントで¥1,200で買えるのに、なぜ¥2,000払う?」
3. 二次市場での購入動機がゼロ → 転売屋は損失
4. 結果: 投機目的の購入が経済合理性を失う

**Kindle等との差別化は維持**:
- ✅ NFTによる真の所有権(譲渡・相続・贈与の自由)
- ✅ ブロックチェーンによる永続性
- ✅ 著者への高い収益配分(85%)
- ✅ 著者コミュニティへのアクセス権
- ❌ 希少性による資産価値上昇(これは投機なので不要)

**物理書籍との類似性**:
- 物理書籍も「絶版」以外は無限に印刷可能 → 新刊本の転売市場は存在しない
- NFT本も同じ構造を再現

#### 影響・トレードオフ

- **ポジティブな影響**:
  - ✅ **投機の構造的排除**: 技術的制約なしで投機が無意味に
  - ✅ **シンプルなUX**: クールダウン等の複雑なルールが不要
  - ✅ **読者ファースト**: 本当に読みたい人が常に定価で購入可能
  - ✅ **著者の安心感**: 自分の作品が投機対象化しない
  - ✅ **メッセージの一貫性**: 「読書文化の尊重」というブランド価値と完全一致

- **ネガティブな影響**:
  - ❌ **希少性マーケティング不可**: 「限定100部!」のような煽りができない
    - **対策**: 限定は「特典コンテンツ」で差別化。本文自体は常にアクセス可能に
  - ❌ **コレクター層へのアピール低下**: NFTコレクターの一部は希少性重視
    - **対策**: 「初版購入者」バッジ、著者サイン入りカバーNFT等で差別化
    - **考え方**: 投機目的コレクターは最初からターゲット外
- ❌ **二次流通市場の活性化困難**: 価格上昇期待がないため流動性低い
  - **対策**: 二次流通は「譲渡文化」として位置付け。著者ロイヤリティは一次販売に集中

**技術的負債**:
- 無限ミントによるコントラクトのガス最適化が重要
- ERC-721標準だとtokenIdが無限に増加 → uint256の上限問題は実質的に無視可能(2^256は天文学的数値)

#### 関連するADR

- ADR-001: サービス終了後の書籍アクセス継続性の保証
- ADR-003: マルチデバイス読書とセッション管理
- ADR-004: 著者への収益配分とスマートコントラクト設計

---

## ADRの更新プロセス

1. 重要な技術決定が必要になったとき、ADRドラフトを作成
2. チームレビュー
3. 承認後、ステータスを「承認済み」に更新
4. 決定が覆された場合、元のADRを「廃止」にし、新しいADRを作成
