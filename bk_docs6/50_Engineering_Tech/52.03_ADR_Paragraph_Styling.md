---
title: "ADR 003: 段落スタイリングの多言語対応"
type: technical
status: accepted
role: TechLead
tags: [adr, styling, i18n, typography]
---

# ADR: 段落スタイリングの多言語対応

## ステータス

採用済み (Accepted)

## コンテキスト

Astranoteエディタは、英語話者と日本語話者の小説家が同じエディタを使用することを想定しています。しかし、英語と日本語では段落の表現慣習が大きく異なります。

### 現在の実装

- Tailwind Typography (`prose prose-lg`) を使用
- 英語向けのデフォルトスタイル
  - 段落間に余白あり (`margin-bottom: 1.25em`)
  - 段落の最初の文字にインデントなし

### 言語別の慣習

#### 日本語の慣習
- **段落開始**: 1文字分（全角）のインデント（字下げ）
- **段落間**: 余白なし、または最小限
- **理由**: 縦書き文化の影響、文字の密度が高い、視覚的な連続性を重視

#### 英語の慣習
- **段落開始**: インデントなし（または最小限）
- **段落間**: 明確な余白（1行分程度）
- **理由**: 横書き文化、段落の明確な分離を重視

### 問題点

1. 現在の実装は英語向けのスタイルであり、日本語小説には不適切
2. 日本語で執筆する作家が段落ごとに字下げを手動で行う必要がある
3. 統一されたエクスポート形式が困難

## 検討した選択肢

### 選択肢1: ユーザー設定で言語モードを切り替え

**概要**: 設定画面で「日本語モード」「英語モード」を選択可能にし、段落スタイルを動的に変更

**メリット**:
- ユーザーの言語に合わせた最適なスタイルを提供
- 明示的な設定で混乱が少ない

**デメリット**:
- UI実装の追加コスト
- 多言語執筆（英語と日本語を混在）する場合に対応できない
- エピソードごとに言語が異なる場合の対応が複雑

### 選択肢2: 自動言語検出

**概要**: コンテンツの言語を自動検出し、適切なスタイルを動的に適用

**メリット**:
- ユーザーの設定不要
- 多言語混在コンテンツにも対応可能

**デメリット**:
- 言語検出の精度に依存
- 検出ロジックの実装コストが高い
- リアルタイム検出はパフォーマンスに影響

### 選択肢3: エディタ内は統一、エクスポート時に変換

**概要**: エディタ内では中立的なスタイル、エクスポート時に言語設定に応じてスタイルを調整

**メリット**:
- エディタの実装がシンプル
- エクスポート時の柔軟性が高い

**デメリット**:
- エディタ内での見た目と出力結果が異なる
- WYSIWYG原則に反する

### 選択肢4: デュアルモードボタンをツールバーに追加（推奨）

**概要**: ツールバーに「段落スタイル切り替え」ボタンを追加し、エピソードごとに日本語スタイル/英語スタイルを切り替え可能にする

**メリット**:
- 実装が比較的シンプル
- エピソードごとに最適なスタイルを選択可能
- ユーザーが明示的に制御できる
- 設定がエピソードのメタデータとして保存される
- リアルタイムでプレビューしながら切り替え可能

**デメリット**:
- ボタンが1つ増える（ツールバーの複雑化）
- 初回利用時にユーザーが選択する必要がある

### 選択肢5: カスタムCSSクラスで両対応

**概要**: `<p>`タグに言語を示すクラスを付与し、CSSで制御

**メリット**:
- 柔軟性が高い
- 段落ごとに異なるスタイルも可能

**デメリット**:
- データモデルが複雑化
- ユーザーの手動設定が必要

## 決定

**統一スタイルの適用（折衷案）**を採用します。

### 最終決定（2026-01-25）

ユーザーフィードバックに基づき、切り替え機能は不要と判断。全言語で統一した段落スタイルを適用することに決定。

**採用スタイル**:
- **text-indent: 0** - 字下げなし
- **margin-bottom: 0.8em** - 適度な段落間余白

### 理由

1. **シンプルさ**: 切り替え機能がなく、UXがシンプル
2. **実装コスト**: 最小限（CSSのみ）
3. **万能性**: 日本語・英語・中国語のいずれにも違和感が少ない
4. **一貫性**: すべてのエピソードで統一されたスタイル
5. **学習コスト**: ユーザーが設定を考える必要がない

### 却下した選択肢

- **選択肢1（日本語スタイル）**: 英語では字下げが不自然
- **選択肢2（欧文スタイル）**: 日本語では段落間余白が大きすぎる
- **選択肢4（切り替え機能）**: 複雑さに見合うメリットがない（ユーザー要望）

## 実装計画

### 実装（完了 ✅）

```css
/* app/src/styles/global.css */

/* 段落スタイル - 日本語/欧文統一（折衷案） */
.ProseMirror p {
  text-indent: 0;        /* 字下げなし */
  margin-bottom: 0.8em;  /* 適度な段落間余白 */
  margin-top: 0;
}

/* 改行（<br>）のスタイル */
.ProseMirror br {
  content: '';
  display: block;
  margin-top: 0;
  line-height: inherit;
}
```

エディタ内での表示のみに適用され、エクスポート機能は実装対象外。

## 影響範囲

### 変更したファイル

1. ✅ **app/src/styles/global.css** - 段落スタイルCSS追加（完了 2026-01-25）

### 変更不要になったファイル

以下のファイルは切り替え機能が不要になったため、変更不要：
- ~~app/src/stores/ui.ts~~ - 段落スタイル状態管理
- ~~app/src/utils/db.ts~~ - Episode型拡張
- ~~app/src/components/interactive/EditorToolbar.svelte~~ - ボタン追加
- ~~app/src/components/interactive/TiptapEditor.svelte~~ - クラス適用ロジック
- ~~app/src/utils/export.ts~~ - エクスポート時のスタイル適用（エクスポート機能は実装対象外）

## 今後の検討事項

### Phase 3以降での検討

1. **縦書きモード**: 日本語小説の縦書き表示機能
2. **詳細なタイポグラフィ設定**: フォント、行間、文字間隔などの細かい調整
3. **テンプレート機能**: 小説ジャンルごとのタイポグラフィテンプレート

### 解決済みの質問

- [x] **Q1**: 統一スタイル vs 切り替え機能？
  - **決定**: 統一スタイル（折衷案）を採用
  - **理由**: シンプルさ、実装コストの低さ

- [x] **Q2**: どのスタイルを統一的に使うか？
  - **決定**: 折衷案（字下げなし、適度な余白）
  - **理由**: 日本語・英語・中国語すべてに違和感が少ない

- [x] **Q3**: margin-bottomの具体的な値は？
  - **決定**: 0.8em
  - **理由**: 大きすぎず小さすぎず、読みやすさと密度のバランス

## 変更履歴

| 日付       | 変更者 | 変更内容                                      |
| ---------- | ------ | --------------------------------------------- |
| 2026/01/28 | Salaim | bkから統合、YAMLフロントマター追加、status更新 |
| 2026-01-25 | Claude | 最終決定：統一スタイル採用                    |

## 関連ドキュメント

- [51.01_TechSpec_Ruby.md](51.01_TechSpec_Ruby.md) - ルビシステム技術仕様
- [52.01_ADR_Tech_Stack.md](52.01_ADR_Tech_Stack.md) - 技術スタック選定
- [53.01_Implementation_Tasks_Multilingual.md](53.01_Implementation_Tasks_Multilingual.md) - 多言語対応実装タスク
